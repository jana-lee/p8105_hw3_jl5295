p8105\_hw3\_jl5295
================
Jana Lee
10/7/2019

\#Problem 1: Instacart

Load the data for Instacart and Exploration of Aisles

``` r
data("instacart")

number_aisles = 
  instacart %>% 
  count(aisle) %>% 
  arrange(desc(n)) %>% 
  view()
```

In the `instacart` dataset, there are 1,384,617 observations and 15
variables. Some key variables in this dataset include `product_name`,
`order_hour_of_day`, and `add_to_cart_order`.

There are 134 unique aisles. The tope 3 aisles most ordered from are,
from most ordered to least: “fresh vegetables” (150,609 orders), “fresh
fruits” (150,473 orders), and “packaged vegetables fruits”(78,493
orders).

Aisle Plot

``` r
aisle_plot = 
  filter(number_aisles, n > 10000)

ggplot(aisle_plot, aes(
    x = reorder(aisle, -n), 
    y = n)) +
  geom_point(color = "red") +
  theme (axis.text.x = element_text(angle = 90, hjust = 1),
         axis.text = element_text(size=8)) +
  labs (
    title = "Plot of Number of Items in Each Aisle for Over 10,000 Items Ordered ",
    x = "Aisle",
    y = "Count of Items Ordered")
```

<img src="p8105_hw3_jl5295_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />
*Please note that plot is ordered by most number of orders to least.*

Table Showing 3 Most Popular Items

``` r
table_pop_items = instacart %>% 
  filter(
    aisle == "baking ingredients" | 
    aisle == "dog food care" | 
    aisle == "packaged vegetables fruits") %>% 
  group_by(aisle, product_name) %>% 
  summarize (n = n()) %>% 
  mutate (top_three = min_rank(desc(n))) %>% 
  filter (top_three <= 3) %>% 
  mutate(sort(top_three, decreasing = FALSE))
  
table_pop_items %>% 
  knitr::kable()
```

| aisle                      | product\_name                                 |    n | top\_three | sort(top\_three, decreasing = FALSE) |
| :------------------------- | :-------------------------------------------- | ---: | ---------: | -----------------------------------: |
| baking ingredients         | Cane Sugar                                    |  336 |          3 |                                    1 |
| baking ingredients         | Light Brown Sugar                             |  499 |          1 |                                    2 |
| baking ingredients         | Pure Baking Soda                              |  387 |          2 |                                    3 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |          2 |                                    1 |
| dog food care              | Small Dog Biscuits                            |   26 |          3 |                                    2 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |          1 |                                    3 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |          1 |                                    1 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |          3 |                                    2 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |          2 |                                    3 |

Table Showing Pink Lady Apples and Coffee Ice Cream Orders

Make a table showing the mean hour of the day at which Pink Lady Apples
and Coffee Ice Cream are ordered on each day of the week; format this
table for human readers (i.e. produce a 2 x 7 table)

``` r
table_apples_coffee = instacart %>% 
  filter(
    product_name == "Pink Lady Apples" | 
    product_name == "Coffee Ice Cream") %>% 
  group_by(product_name, order_hour_of_day, order_dow) %>% 
  summarize(n = n()) %>% 
  mutate (table_apple_coffee = mean(order_hour_of_day))

table_apples_coffee %>% 
  knitr::kable()
```

| product\_name    | order\_hour\_of\_day | order\_dow |  n | table\_apple\_coffee |
| :--------------- | -------------------: | ---------: | -: | -------------------: |
| Coffee Ice Cream |                    1 |          5 |  1 |                    1 |
| Coffee Ice Cream |                    1 |          6 |  1 |                    1 |
| Coffee Ice Cream |                    2 |          5 |  1 |                    2 |
| Coffee Ice Cream |                    5 |          1 |  1 |                    5 |
| Coffee Ice Cream |                    7 |          1 |  2 |                    7 |
| Coffee Ice Cream |                    7 |          2 |  1 |                    7 |
| Coffee Ice Cream |                    8 |          0 |  3 |                    8 |
| Coffee Ice Cream |                    8 |          5 |  1 |                    8 |
| Coffee Ice Cream |                    8 |          6 |  2 |                    8 |
| Coffee Ice Cream |                    9 |          0 |  2 |                    9 |
| Coffee Ice Cream |                    9 |          1 |  1 |                    9 |
| Coffee Ice Cream |                    9 |          2 |  1 |                    9 |
| Coffee Ice Cream |                    9 |          3 |  2 |                    9 |
| Coffee Ice Cream |                    9 |          4 |  2 |                    9 |
| Coffee Ice Cream |                    9 |          5 |  1 |                    9 |
| Coffee Ice Cream |                    9 |          6 |  5 |                    9 |
| Coffee Ice Cream |                   10 |          0 |  3 |                   10 |
| Coffee Ice Cream |                   10 |          5 |  3 |                   10 |
| Coffee Ice Cream |                   10 |          6 |  2 |                   10 |
| Coffee Ice Cream |                   11 |          0 |  1 |                   11 |
| Coffee Ice Cream |                   11 |          1 |  1 |                   11 |
| Coffee Ice Cream |                   11 |          2 |  1 |                   11 |
| Coffee Ice Cream |                   11 |          3 |  4 |                   11 |
| Coffee Ice Cream |                   11 |          4 |  2 |                   11 |
| Coffee Ice Cream |                   11 |          5 |  1 |                   11 |
| Coffee Ice Cream |                   11 |          6 |  3 |                   11 |
| Coffee Ice Cream |                   12 |          1 |  1 |                   12 |
| Coffee Ice Cream |                   12 |          2 |  1 |                   12 |
| Coffee Ice Cream |                   12 |          4 |  2 |                   12 |
| Coffee Ice Cream |                   12 |          5 |  2 |                   12 |
| Coffee Ice Cream |                   13 |          0 |  4 |                   13 |
| Coffee Ice Cream |                   13 |          2 |  2 |                   13 |
| Coffee Ice Cream |                   13 |          3 |  2 |                   13 |
| Coffee Ice Cream |                   13 |          4 |  1 |                   13 |
| Coffee Ice Cream |                   13 |          5 |  1 |                   13 |
| Coffee Ice Cream |                   13 |          6 |  3 |                   13 |
| Coffee Ice Cream |                   14 |          0 |  4 |                   14 |
| Coffee Ice Cream |                   14 |          1 |  1 |                   14 |
| Coffee Ice Cream |                   14 |          2 |  2 |                   14 |
| Coffee Ice Cream |                   14 |          3 |  1 |                   14 |
| Coffee Ice Cream |                   14 |          4 |  3 |                   14 |
| Coffee Ice Cream |                   14 |          5 |  1 |                   14 |
| Coffee Ice Cream |                   14 |          6 |  1 |                   14 |
| Coffee Ice Cream |                   15 |          0 |  5 |                   15 |
| Coffee Ice Cream |                   15 |          1 |  1 |                   15 |
| Coffee Ice Cream |                   15 |          2 |  2 |                   15 |
| Coffee Ice Cream |                   15 |          3 |  3 |                   15 |
| Coffee Ice Cream |                   15 |          4 |  1 |                   15 |
| Coffee Ice Cream |                   15 |          5 |  2 |                   15 |
| Coffee Ice Cream |                   15 |          6 |  2 |                   15 |
| Coffee Ice Cream |                   16 |          0 |  1 |                   16 |
| Coffee Ice Cream |                   16 |          1 |  5 |                   16 |
| Coffee Ice Cream |                   16 |          3 |  1 |                   16 |
| Coffee Ice Cream |                   16 |          4 |  3 |                   16 |
| Coffee Ice Cream |                   16 |          5 |  1 |                   16 |
| Coffee Ice Cream |                   16 |          6 |  5 |                   16 |
| Coffee Ice Cream |                   17 |          0 |  3 |                   17 |
| Coffee Ice Cream |                   17 |          1 |  3 |                   17 |
| Coffee Ice Cream |                   17 |          2 |  4 |                   17 |
| Coffee Ice Cream |                   17 |          3 |  1 |                   17 |
| Coffee Ice Cream |                   17 |          4 |  4 |                   17 |
| Coffee Ice Cream |                   17 |          5 |  1 |                   17 |
| Coffee Ice Cream |                   17 |          6 |  7 |                   17 |
| Coffee Ice Cream |                   18 |          0 |  1 |                   18 |
| Coffee Ice Cream |                   18 |          2 |  4 |                   18 |
| Coffee Ice Cream |                   18 |          3 |  2 |                   18 |
| Coffee Ice Cream |                   18 |          4 |  1 |                   18 |
| Coffee Ice Cream |                   18 |          6 |  1 |                   18 |
| Coffee Ice Cream |                   19 |          0 |  4 |                   19 |
| Coffee Ice Cream |                   19 |          1 |  1 |                   19 |
| Coffee Ice Cream |                   19 |          2 |  1 |                   19 |
| Coffee Ice Cream |                   19 |          3 |  2 |                   19 |
| Coffee Ice Cream |                   19 |          5 |  2 |                   19 |
| Coffee Ice Cream |                   19 |          6 |  1 |                   19 |
| Coffee Ice Cream |                   20 |          2 |  1 |                   20 |
| Coffee Ice Cream |                   20 |          3 |  2 |                   20 |
| Coffee Ice Cream |                   20 |          4 |  2 |                   20 |
| Coffee Ice Cream |                   20 |          5 |  1 |                   20 |
| Coffee Ice Cream |                   20 |          6 |  1 |                   20 |
| Coffee Ice Cream |                   21 |          1 |  2 |                   21 |
| Coffee Ice Cream |                   21 |          2 |  1 |                   21 |
| Coffee Ice Cream |                   21 |          3 |  1 |                   21 |
| Coffee Ice Cream |                   21 |          4 |  2 |                   21 |
| Coffee Ice Cream |                   21 |          6 |  1 |                   21 |
| Coffee Ice Cream |                   22 |          3 |  1 |                   22 |
| Coffee Ice Cream |                   23 |          6 |  1 |                   23 |
| Pink Lady Apples |                    0 |          4 |  1 |                    0 |
| Pink Lady Apples |                    3 |          5 |  1 |                    3 |
| Pink Lady Apples |                    5 |          2 |  1 |                    5 |
| Pink Lady Apples |                    5 |          5 |  1 |                    5 |
| Pink Lady Apples |                    6 |          0 |  1 |                    6 |
| Pink Lady Apples |                    6 |          1 |  2 |                    6 |
| Pink Lady Apples |                    6 |          2 |  2 |                    6 |
| Pink Lady Apples |                    6 |          4 |  1 |                    6 |
| Pink Lady Apples |                    6 |          6 |  1 |                    6 |
| Pink Lady Apples |                    7 |          0 |  1 |                    7 |
| Pink Lady Apples |                    7 |          1 |  1 |                    7 |
| Pink Lady Apples |                    7 |          2 |  6 |                    7 |
| Pink Lady Apples |                    7 |          4 |  1 |                    7 |
| Pink Lady Apples |                    7 |          5 |  1 |                    7 |
| Pink Lady Apples |                    7 |          6 |  2 |                    7 |
| Pink Lady Apples |                    8 |          0 |  2 |                    8 |
| Pink Lady Apples |                    8 |          1 |  6 |                    8 |
| Pink Lady Apples |                    8 |          2 |  3 |                    8 |
| Pink Lady Apples |                    8 |          3 |  1 |                    8 |
| Pink Lady Apples |                    8 |          4 |  1 |                    8 |
| Pink Lady Apples |                    8 |          5 |  5 |                    8 |
| Pink Lady Apples |                    9 |          0 |  2 |                    9 |
| Pink Lady Apples |                    9 |          1 | 11 |                    9 |
| Pink Lady Apples |                    9 |          2 |  5 |                    9 |
| Pink Lady Apples |                    9 |          3 |  3 |                    9 |
| Pink Lady Apples |                    9 |          4 |  3 |                    9 |
| Pink Lady Apples |                    9 |          5 |  6 |                    9 |
| Pink Lady Apples |                    9 |          6 |  1 |                    9 |
| Pink Lady Apples |                   10 |          0 |  4 |                   10 |
| Pink Lady Apples |                   10 |          1 |  9 |                   10 |
| Pink Lady Apples |                   10 |          2 |  5 |                   10 |
| Pink Lady Apples |                   10 |          3 |  5 |                   10 |
| Pink Lady Apples |                   10 |          4 |  4 |                   10 |
| Pink Lady Apples |                   10 |          5 |  4 |                   10 |
| Pink Lady Apples |                   10 |          6 |  1 |                   10 |
| Pink Lady Apples |                   11 |          0 |  4 |                   11 |
| Pink Lady Apples |                   11 |          1 |  5 |                   11 |
| Pink Lady Apples |                   11 |          2 |  5 |                   11 |
| Pink Lady Apples |                   11 |          3 |  5 |                   11 |
| Pink Lady Apples |                   11 |          4 |  4 |                   11 |
| Pink Lady Apples |                   11 |          5 |  5 |                   11 |
| Pink Lady Apples |                   11 |          6 |  3 |                   11 |
| Pink Lady Apples |                   12 |          0 |  2 |                   12 |
| Pink Lady Apples |                   12 |          1 |  3 |                   12 |
| Pink Lady Apples |                   12 |          2 |  3 |                   12 |
| Pink Lady Apples |                   12 |          3 |  2 |                   12 |
| Pink Lady Apples |                   12 |          4 |  4 |                   12 |
| Pink Lady Apples |                   12 |          5 |  2 |                   12 |
| Pink Lady Apples |                   12 |          6 |  1 |                   12 |
| Pink Lady Apples |                   13 |          0 |  3 |                   13 |
| Pink Lady Apples |                   13 |          1 |  4 |                   13 |
| Pink Lady Apples |                   13 |          2 |  1 |                   13 |
| Pink Lady Apples |                   13 |          3 |  3 |                   13 |
| Pink Lady Apples |                   13 |          4 |  1 |                   13 |
| Pink Lady Apples |                   13 |          5 |  3 |                   13 |
| Pink Lady Apples |                   13 |          6 |  2 |                   13 |
| Pink Lady Apples |                   14 |          0 |  2 |                   14 |
| Pink Lady Apples |                   14 |          2 |  5 |                   14 |
| Pink Lady Apples |                   14 |          3 |  2 |                   14 |
| Pink Lady Apples |                   14 |          4 |  3 |                   14 |
| Pink Lady Apples |                   14 |          5 |  5 |                   14 |
| Pink Lady Apples |                   14 |          6 |  1 |                   14 |
| Pink Lady Apples |                   15 |          0 |  5 |                   15 |
| Pink Lady Apples |                   15 |          2 |  3 |                   15 |
| Pink Lady Apples |                   15 |          4 |  1 |                   15 |
| Pink Lady Apples |                   15 |          5 |  4 |                   15 |
| Pink Lady Apples |                   16 |          0 |  1 |                   16 |
| Pink Lady Apples |                   16 |          1 |  4 |                   16 |
| Pink Lady Apples |                   16 |          2 |  2 |                   16 |
| Pink Lady Apples |                   16 |          4 |  3 |                   16 |
| Pink Lady Apples |                   16 |          5 |  4 |                   16 |
| Pink Lady Apples |                   16 |          6 |  2 |                   16 |
| Pink Lady Apples |                   17 |          2 |  1 |                   17 |
| Pink Lady Apples |                   17 |          3 |  2 |                   17 |
| Pink Lady Apples |                   17 |          4 |  1 |                   17 |
| Pink Lady Apples |                   17 |          5 |  5 |                   17 |
| Pink Lady Apples |                   17 |          6 |  1 |                   17 |
| Pink Lady Apples |                   18 |          2 |  1 |                   18 |
| Pink Lady Apples |                   18 |          3 |  1 |                   18 |
| Pink Lady Apples |                   18 |          6 |  1 |                   18 |
| Pink Lady Apples |                   19 |          0 |  1 |                   19 |
| Pink Lady Apples |                   19 |          1 |  1 |                   19 |
| Pink Lady Apples |                   19 |          2 |  1 |                   19 |
| Pink Lady Apples |                   19 |          5 |  1 |                   19 |
| Pink Lady Apples |                   20 |          0 |  2 |                   20 |
| Pink Lady Apples |                   20 |          1 |  1 |                   20 |
| Pink Lady Apples |                   20 |          3 |  1 |                   20 |
| Pink Lady Apples |                   20 |          4 |  1 |                   20 |
| Pink Lady Apples |                   21 |          0 |  3 |                   21 |
| Pink Lady Apples |                   21 |          1 |  1 |                   21 |
| Pink Lady Apples |                   21 |          2 |  1 |                   21 |
| Pink Lady Apples |                   21 |          3 |  2 |                   21 |
| Pink Lady Apples |                   21 |          5 |  2 |                   21 |
| Pink Lady Apples |                   22 |          0 |  1 |                   22 |
| Pink Lady Apples |                   22 |          1 |  1 |                   22 |
| Pink Lady Apples |                   22 |          3 |  4 |                   22 |
| Pink Lady Apples |                   22 |          5 |  1 |                   22 |
| Pink Lady Apples |                   23 |          1 |  1 |                   23 |
| Pink Lady Apples |                   23 |          2 |  2 |                   23 |
| Pink Lady Apples |                   23 |          3 |  1 |                   23 |
| Pink Lady Apples |                   23 |          5 |  1 |                   23 |

# Problem 2: BRFSS

Loading & Data Cleaning:

``` r
data("brfss_smart2010")

brfss = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(
    topic == "Overall Health" |
    response == "Poor" | response == "Fair" | response == "Very Good" |response == "Excellent") %>% 
  mutate(response = factor(response,labels = c("Poor", "Fair", "Good", "Very good", "Excellent"))) %>% 
  select(-location_id, -data_value_footnote_symbol, -data_value_footnote)

brfss
```

    ## # A tibble: 10,625 x 20
    ##     year locationabbr locationdesc class topic question response
    ##    <int> <chr>        <chr>        <chr> <chr> <chr>    <fct>   
    ##  1  2010 AL           AL - Jeffer… Heal… Over… How is … Poor    
    ##  2  2010 AL           AL - Jeffer… Heal… Over… How is … Excelle…
    ##  3  2010 AL           AL - Jeffer… Heal… Over… How is … Good    
    ##  4  2010 AL           AL - Jeffer… Heal… Over… How is … Fair    
    ##  5  2010 AL           AL - Jeffer… Heal… Over… How is … Very go…
    ##  6  2010 AL           AL - Mobile… Heal… Over… How is … Poor    
    ##  7  2010 AL           AL - Mobile… Heal… Over… How is … Excelle…
    ##  8  2010 AL           AL - Mobile… Heal… Over… How is … Good    
    ##  9  2010 AL           AL - Mobile… Heal… Over… How is … Fair    
    ## 10  2010 AL           AL - Mobile… Heal… Over… How is … Very go…
    ## # … with 10,615 more rows, and 13 more variables: sample_size <int>,
    ## #   data_value <dbl>, confidence_limit_low <dbl>,
    ## #   confidence_limit_high <dbl>, display_order <int>,
    ## #   data_value_unit <chr>, data_value_type <chr>, data_source <chr>,
    ## #   class_id <chr>, topic_id <chr>, question_id <chr>, respid <chr>,
    ## #   geo_location <chr>

In 2002, which states were observed at 7 or more locations? What about
in 2010?

Construct a dataset that is limited to Excellent responses, and
contains, year, state, and a variable that averages the data\_value
across locations within a state. Make a “spaghetti” plot of this average
value over time within a state (that is, make a plot showing a line for
each state across years – the geom\_line geometry and group aesthetic
will help).

# Problem 3:
